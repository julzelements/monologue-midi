{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "MonologueParameters",
  "description": "Complete parameter schema for Korg Monologue synthesizer patches",
  "type": "object",
  "required": ["patchName", "panelSettings", "programSettings", "sequencerSettings", "sequencerSteps"],
  "properties": {
    "patchName": {
      "type": "string",
      "maxLength": 12,
      "description": "Patch name, max 12 characters"
    },
    "panelSettings": {
      "type": "object",
      "required": ["drive", "keyboardOctave", "syncRing", "seqTrig", "oscilators", "filter", "envelope", "lfo"],
      "properties": {
        "drive": {
          "$ref": "#/definitions/namedValue",
          "description": "Drive amount (10-bit value)"
        },
        "keyboardOctave": {
          "$ref": "#/definitions/namedValue",
          "description": "Keyboard octave transpose: 0=-2, 1=-1, 2=0, 3=+1, 4=+2"
        },
        "syncRing": {
          "$ref": "#/definitions/namedValue",
          "description": "SYNC/RING: 0=RING, 1=OFF, 2=SYNC"
        },
        "seqTrig": {
          "$ref": "#/definitions/namedValue",
          "description": "Sequencer: Key Trigger/Hold: 0=OFF, 1=ON"
        },
        "oscilators": {
          "type": "object",
          "required": ["vco1", "vco2"],
          "properties": {
            "vco1": {
              "$ref": "#/definitions/vco1"
            },
            "vco2": {
              "$ref": "#/definitions/vco2"
            }
          },
          "additionalProperties": false
        },
        "filter": {
          "type": "object",
          "required": ["cutoff", "resonance"],
          "properties": {
            "cutoff": {
              "$ref": "#/definitions/namedValue",
              "description": "Filter cutoff frequency (10-bit value)"
            },
            "resonance": {
              "$ref": "#/definitions/namedValue",
              "description": "Filter resonance (10-bit value)"
            }
          },
          "additionalProperties": false
        },
        "envelope": {
          "type": "object",
          "required": ["type", "attack", "decay", "intensity", "target"],
          "properties": {
            "type": {
              "$ref": "#/definitions/namedValue",
              "description": "Envelope type: 0=GATE, 1=A/G/D, 2=A/D"
            },
            "attack": {
              "$ref": "#/definitions/namedValue",
              "description": "Attack time (10-bit value)"
            },
            "decay": {
              "$ref": "#/definitions/namedValue",
              "description": "Decay time (10-bit value)"
            },
            "intensity": {
              "$ref": "#/definitions/namedValue",
              "description": "Envelope intensity (bipolar)"
            },
            "target": {
              "$ref": "#/definitions/namedValue",
              "description": "EG Target: 0=CUTOFF, 1=PITCH 2, 2=PITCH"
            }
          },
          "additionalProperties": false
        },
        "lfo": {
          "type": "object",
          "required": ["wave", "mode", "rate", "intensity", "target"],
          "properties": {
            "wave": {
              "$ref": "#/definitions/namedValue",
              "description": "LFO wave: 0=SQR, 1=TRI, 2=SAW"
            },
            "mode": {
              "$ref": "#/definitions/namedValue",
              "description": "LFO mode: 0=1-SHOT, 1=SLOW, 2=FAST"
            },
            "rate": {
              "$ref": "#/definitions/namedValue",
              "description": "LFO rate (10-bit value)"
            },
            "intensity": {
              "$ref": "#/definitions/namedValue",
              "description": "LFO intensity (bipolar)"
            },
            "target": {
              "$ref": "#/definitions/namedValue",
              "description": "LFO Target: 0=CUTOFF, 1=SHAPE, 2=PITCH"
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "programSettings": {
      "type": "object",
      "required": ["portamento", "slider", "pitch", "other"],
      "properties": {
        "portamento": {
          "type": "object",
          "required": ["time", "mode", "slideTime"],
          "properties": {
            "time": {
              "$ref": "#/definitions/namedValue",
              "description": "Portamento time: 0=OFF, 1-128"
            },
            "mode": {
              "$ref": "#/definitions/namedValue",
              "description": "Portamento mode: 0=Auto, 1=On"
            },
            "slideTime": {
              "$ref": "#/definitions/namedValue",
              "description": "Slide time: 0-72 = 0% - 100%"
            }
          },
          "additionalProperties": false
        },
        "slider": {
          "type": "object",
          "required": ["assign", "bendRangePlus", "bendRangeMinus"],
          "properties": {
            "assign": {
              "$ref": "#/definitions/namedValue",
              "description": "Parameter assigned to slider (CC number)"
            },
            "bendRangePlus": {
              "$ref": "#/definitions/namedValue",
              "description": "Pitch bend range (+): 1-12 semitones"
            },
            "bendRangeMinus": {
              "$ref": "#/definitions/namedValue",
              "description": "Pitch bend range (-): 1-12 semitones"
            }
          },
          "additionalProperties": false
        },
        "pitch": {
          "type": "object",
          "required": ["microTuning", "scaleKey", "programTuning"],
          "properties": {
            "microTuning": {
              "$ref": "#/definitions/namedValue",
              "description": "Micro tuning scale selection"
            },
            "scaleKey": {
              "$ref": "#/definitions/namedValue",
              "description": "Scale key: 0-24 = -12 to +12 keys"
            },
            "programTuning": {
              "$ref": "#/definitions/namedValue",
              "description": "Program tuning: 0-100 = -50 to +50 cents"
            }
          },
          "additionalProperties": false
        },
        "other": {
          "type": "object",
          "required": ["lfoBpmSync", "cutoffKeyTrack", "cutoffVelocity", "ampVelocity", "programLevel"],
          "properties": {
            "lfoBpmSync": {
              "$ref": "#/definitions/namedValue",
              "description": "LFO BPM sync: 0=Off, 1=On"
            },
            "cutoffKeyTrack": {
              "$ref": "#/definitions/namedValue",
              "description": "Cutoff key tracking: 0=0%, 1=50%, 2=100%"
            },
            "cutoffVelocity": {
              "$ref": "#/definitions/namedValue",
              "description": "Cutoff velocity sensitivity: 0=0%, 1=50%, 2=100%"
            },
            "ampVelocity": {
              "$ref": "#/definitions/namedValue",
              "description": "Amp velocity sensitivity"
            },
            "programLevel": {
              "$ref": "#/definitions/namedValue",
              "description": "Program level: 77-127 = -25 to +25"
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "sequencerSettings": {
      "type": "object",
      "required": ["bpm", "stepLength", "stepResolution", "swing", "defaultGateTime", "motionSlotParams"],
      "properties": {
        "bpm": {
          "$ref": "#/definitions/namedValue",
          "description": "Sequencer BPM"
        },
        "stepLength": {
          "$ref": "#/definitions/namedValue",
          "description": "Number of steps in sequence (1-16)"
        },
        "stepResolution": {
          "$ref": "#/definitions/namedValue",
          "description": "Step resolution"
        },
        "swing": {
          "$ref": "#/definitions/namedValue",
          "description": "Swing amount"
        },
        "defaultGateTime": {
          "$ref": "#/definitions/namedValue",
          "description": "Default gate time for steps"
        },
        "motionSlotParams": {
          "type": "array",
          "minItems": 4,
          "maxItems": 4,
          "items": {
            "$ref": "#/definitions/motionSlot"
          },
          "description": "Four motion sequencing parameter slots"
        }
      },
      "additionalProperties": false
    },
    "sequencerSteps": {
      "type": "array",
      "minItems": 16,
      "maxItems": 16,
      "items": {
        "$ref": "#/definitions/sequencerStep"
      },
      "description": "16 sequencer steps"
    }
  },
  "additionalProperties": false,
  "definitions": {
    "namedValue": {
      "type": "object",
      "required": ["name", "value"],
      "properties": {
        "name": {
          "type": "string",
          "description": "Parameter name"
        },
        "value": {
          "type": "integer",
          "description": "Parameter value"
        }
      },
      "additionalProperties": false
    },
    "vco1": {
      "type": "object",
      "required": ["wave", "shape", "level", "pitch", "octave"],
      "properties": {
        "wave": {
          "$ref": "#/definitions/namedValue",
          "description": "VCO1 Waveform: 0=SQR, 1=TRI, 2=SAW"
        },
        "shape": {
          "$ref": "#/definitions/namedValue",
          "description": "Wave shape (10-bit value)"
        },
        "level": {
          "$ref": "#/definitions/namedValue",
          "description": "Oscillator level (10-bit value)"
        },
        "pitch": {
          "$ref": "#/definitions/namedValue",
          "description": "Pitch offset (10-bit value)"
        },
        "octave": {
          "$ref": "#/definitions/namedValue",
          "description": "Octave: 0=16', 1=8', 2=4', 3=2'"
        }
      },
      "additionalProperties": false
    },
    "vco2": {
      "type": "object",
      "required": ["wave", "shape", "level", "pitch", "octave"],
      "properties": {
        "wave": {
          "$ref": "#/definitions/namedValue",
          "description": "VCO2 Waveform: 0=NOISE, 1=TRI, 2=SAW"
        },
        "shape": {
          "$ref": "#/definitions/namedValue",
          "description": "Wave shape (10-bit value)"
        },
        "level": {
          "$ref": "#/definitions/namedValue",
          "description": "Oscillator level (10-bit value)"
        },
        "pitch": {
          "$ref": "#/definitions/namedValue",
          "description": "Pitch offset (10-bit value)"
        },
        "octave": {
          "$ref": "#/definitions/namedValue",
          "description": "Octave: 0=16', 1=8', 2=4', 3=2'"
        }
      },
      "additionalProperties": false
    },
    "motionSlot": {
      "type": "object",
      "required": ["slotNumber", "active", "smooth", "parameter", "stepFlags"],
      "properties": {
        "slotNumber": {
          "type": "integer",
          "minimum": 1,
          "maximum": 4,
          "description": "Motion slot number (1-4)"
        },
        "active": {
          "$ref": "#/definitions/namedValue",
          "description": "Motion slot on/off: 0=OFF, 1=ON"
        },
        "smooth": {
          "$ref": "#/definitions/namedValue",
          "description": "Motion smooth on/off: 0=OFF, 1=ON"
        },
        "parameter": {
          "$ref": "#/definitions/namedValue",
          "description": "Parameter assigned to this motion slot"
        },
        "stepFlags": {
          "type": "array",
          "minItems": 16,
          "maxItems": 16,
          "items": {
            "type": "integer",
            "minimum": 0,
            "maximum": 1
          },
          "description": "Per-step flags indicating which steps this motion slot is active on (16 boolean values, 0=OFF, 1=ON)"
        }
      },
      "additionalProperties": false
    },
    "sequencerStep": {
      "type": "object",
      "required": ["stepNumber", "active", "motionActive", "slideActive", "event"],
      "properties": {
        "stepNumber": {
          "type": "integer",
          "minimum": 1,
          "maximum": 16,
          "description": "Step number (1-16)"
        },
        "active": {
          "$ref": "#/definitions/namedValue",
          "description": "Step on/off: 0=OFF, 1=ON"
        },
        "motionActive": {
          "$ref": "#/definitions/namedValue",
          "description": "Motion on/off for this step: 0=OFF, 1=ON"
        },
        "slideActive": {
          "$ref": "#/definitions/namedValue",
          "description": "Slide on/off for this step: 0=OFF, 1=ON"
        },
        "event": {
          "$ref": "#/definitions/stepEvent"
        }
      },
      "additionalProperties": false
    },
    "stepEvent": {
      "type": "object",
      "required": ["note", "motionSlotsData"],
      "properties": {
        "note": {
          "$ref": "#/definitions/noteEvent"
        },
        "motionSlotsData": {
          "type": "array",
          "minItems": 4,
          "maxItems": 4,
          "items": {
            "type": "array",
            "minItems": 4,
            "maxItems": 4,
            "items": {
              "$ref": "#/definitions/namedValue"
            }
          },
          "description": "Motion data for 4 slots, each with 4 data points"
        }
      },
      "additionalProperties": false
    },
    "noteEvent": {
      "type": "object",
      "required": ["key", "velocity", "gateTime", "trigger"],
      "properties": {
        "key": {
          "$ref": "#/definitions/namedValue",
          "description": "MIDI note number"
        },
        "velocity": {
          "$ref": "#/definitions/namedValue",
          "description": "Note velocity (0-127)"
        },
        "gateTime": {
          "$ref": "#/definitions/namedValue",
          "description": "Note gate time"
        },
        "trigger": {
          "$ref": "#/definitions/namedValue",
          "description": "Trigger mode"
        }
      },
      "additionalProperties": false
    }
  }
}
